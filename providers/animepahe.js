/**
 * animepahe - Built from src/animepahe/
 * Generated: 2026-01-10T09:52:21.099Z
 */
var j=Object.create;var T=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var G=Object.getOwnPropertyNames,K=Object.getOwnPropertySymbols,Y=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var L=(t,e,n)=>e in t?T(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,I=(t,e)=>{for(var n in e||(e={}))M.call(e,n)&&L(t,n,e[n]);if(K)for(var n of K(e))X.call(e,n)&&L(t,n,e[n]);return t};var Q=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of G(e))!M.call(t,s)&&s!==n&&T(t,s,{get:()=>e[s],enumerable:!(o=z(e,s))||o.enumerable});return t};var R=(t,e,n)=>(n=t!=null?j(Y(t)):{},Q(e||!t||!t.__esModule?T(n,"default",{value:t,enumerable:!0}):n,t));var f=(t,e,n)=>new Promise((o,s)=>{var i=r=>{try{c(n.next(r))}catch(a){s(a)}},p=r=>{try{c(n.throw(r))}catch(a){s(a)}},c=r=>r.done?o(r.value):Promise.resolve(r.value).then(i,p);c((n=n.apply(t,e)).next())});var q="https://animepahe.si",U="https://animepahe.si/api",F={"User-Agent":"Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Mobile Safari/537.36",Cookie:"__ddg2_=1234567890",Referer:"https://animepahe.si/"},O="68e094699525b18a70bab2f86b1fa706";function D(n){return f(this,arguments,function*(t,e={}){console.log(`[AnimePahe] Fetching: ${t}`);let o=yield fetch(t,I({headers:I(I({},F),e.headers)},e));if(!o.ok)throw new Error(`HTTP error ${o.status} for ${t}`);return yield o.text()})}function b(n){return f(this,arguments,function*(t,e={}){let o=yield D(t,e);try{return JSON.parse(o)}catch(s){throw console.error(`[AnimePahe] Failed to parse JSON from ${t}:`,o.substring(0,100)),s}})}function v(t,e){return f(this,null,function*(){let n=`https://api.themoviedb.org/3/${e}/${t}?api_key=${O}`;console.log(`[AnimePahe] Fetching TMDB details from: ${n}`);try{let o=yield b(n),s=o.name||o.title||o.original_name,i=(o.first_air_date||o.release_date||"").substring(0,4);return{title:s,year:i}}catch(o){return console.error("[AnimePahe] Failed to fetch TMDB metadata",o),null}})}var B=R(require("cheerio-without-node-native"));function H(t){return/eval\(function\(/.test(t)}function V(t){try{let e,n,o,s,i,p,c=/eval\(function\(p,a,c,k,e,d\)\{.+?return p\}\('(.+?)',(\d+),(\d+),'(.+?)'\.split\('\|'\),0,\{\}\)/,r=t.match(c);if(!r)return t;for(e=r[1],n=parseInt(r[2]),o=parseInt(r[3]),s=r[4].split("|"),i=function(a){return(a<n?"":i(parseInt(a/n)))+((a=a%n)>35?String.fromCharCode(a+29):a.toString(36))};o--;)s[o]&&(e=e.replace(new RegExp("\\b"+i(o)+"\\b","g"),s[o]));return e}catch(e){return console.error("Unpack error",e),t}}function Z(t,e,n,o){let s="",i=0,p=e[o];for(;i<t.length;){let c=t.indexOf(p,i);if(c===-1)break;let r="";for(let a=i;a<c;a++)r+=e.indexOf(t[a]);i=c+1;try{let a=String.fromCharCode(parseInt(r,o)-n);s+=a}catch(a){}}return s}function J(t){return f(this,null,function*(){console.log(`[Kwik] Extracting: ${t}`);let e=t;if(t.includes("pahe.win"))try{let r=yield fetch(`${t}/i`,{redirect:"manual"});if(r.status===302||r.status===301){let a=r.headers.get("location");if(a){let l=a.lastIndexOf("https://");l!==-1?e=a.substring(l):e=a}}else{let a=yield r.text()}}catch(r){console.log("[Kwik] Pahe redirect check failed:",r)}console.log(`[Kwik] Target URL: ${e}`);let n=yield fetch(e,{headers:{Referer:"https://animepahe.si/"}}),o=yield n.text(),s=n.headers.get("set-cookie")||"",i=o.match(/source=\s*['"](.*?)['"]/);if(i)return i[1];let p=/\(\"(\w+)\",\d+,\"(\w+)\",(\d+),(\d+),\d+\)/,c=o.match(p);if(c){console.log("[Kwik] Found obfuscated parameters, decrypting...");let[r,a,l,x,m]=c,g=Z(a,l,parseInt(x),parseInt(m)),$=g.match(/action=\"([^\"]+)\"/),P=g.match(/value=\"([^\"]+)\"/);if($&&P){let C=$[1],w=P[1];console.log(`[Kwik] POST to ${C} with token ${w}`);let k=yield fetch(C,{method:"POST",headers:{Referer:e,Cookie:s,"User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36","Content-Type":"application/x-www-form-urlencoded"},body:`_token=${w}`,redirect:"manual"});if(k.status===302||k.status===301)return k.headers.get("location")}}if(H(o)){let r=B.default.load(o),a=null;if(r("script").each((l,x)=>{let m=r(x).html();if(m&&H(m)){let $=V(m).match(/source=\s*['"](.*?)['"]/);$&&(a=$[1])}}),a)return a}return null})}var N=R(require("cheerio-without-node-native"));function ee(t,e,n,o,s=null){return f(this,null,function*(){try{n||(n=1),o||(o=1);let i=s||(yield v(t,e));if(!i)return[];let{title:p,year:c}=i;console.log(`[AnimePahe] Processing: ${p} (${c}) S${n}E${o}`);let r=`${U}?m=search&l=8&q=${encodeURIComponent(p)}`,a=yield b(r);if(!a||!a.data||a.data.length===0)return console.log("[AnimePahe] No search results found."),[];let l=a.data.find(h=>h.title.toLowerCase()===p.toLowerCase());!l&&c&&(l=a.data.find(h=>h.year==c)),l||(l=a.data[0]),console.log(`[AnimePahe] Selected Anime: ${l.title} (Session: ${l.session})`);let x=l.session,m=1,g=null,$=1;for(;!g&&m<=$;){let h=`${U}?m=release&id=${x}&sort=episode_asc&page=${m}`,d=yield b(h);$=d.last_page;let u=d.data.find(y=>y.episode==o);u?(g=u.session,console.log(`[AnimePahe] Found Episode ${o} (Session: ${g})`)):m++}if(!g)return console.log(`[AnimePahe] Episode ${o} not found.`),[];let P=`${q}/play/${x}/${g}`,C=yield D(P),w=N.default.load(C),k=[];w("#resolutionMenu button").each((h,d)=>{let u=w(d).attr("data-src"),y=w(d).text(),A=y.match(/(\d{3,4}p)/),S=A?A[1]:"Unknown",_=y.toLowerCase().includes("eng")||y.toLowerCase().includes("dub")?"Dub":"Sub";u&&u.includes("kwik")&&k.push({url:u,quality:S,lang:_,type:"kwik"})}),w("div#pickDownload > a").each((h,d)=>{let u=w(d).attr("href"),y=w(d).text(),A=y.match(/(\d{3,4}p)/),S=A?A[1]:"Unknown",_=y.toLowerCase().includes("eng")||y.toLowerCase().includes("dub")?"Dub":"Sub";u&&(u.includes("kwik")?k.push({url:u,quality:S,lang:_,type:"kwik"}):k.push({url:u,quality:S,lang:_,type:"pahe"}))});let E=[];for(let h of k)try{let d=yield J(h.url);d&&E.push({name:`AnimePahe ${h.lang}`,title:`AnimePahe ${h.quality} ${h.lang}`,url:d,quality:h.quality})}catch(d){console.error(`[AnimePahe] Failed to extract Kwik: ${d.message}`)}return E}catch(i){return console.error(`[AnimePahe] Error: ${i.message}`),[]}})}function te(t){return f(this,null,function*(){try{let e=`${U}?m=search&l=8&q=${encodeURIComponent(t)}`,n=yield b(e);return!n||!n.data||n.data.length===0?[]:n.data.map(o=>({name:"AnimePahe",title:o.title,url:o.session,poster:o.poster,year:o.year,type:o.type.toLowerCase().includes("movie")?"movie":"tv"}))}catch(e){return console.error(`[AnimePahe] Search error: ${e.message}`),[]}})}module.exports={getStreams:ee,search:te};
